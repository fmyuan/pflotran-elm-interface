#Description: Batch carbonate equilibrium speciation reaction

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_TRANSPORT transport
      GLOBAL_IMPLICIT
    /
  /
END

SUBSURFACE

#=========================== regression =======================================
REGRESSION
  CELLS_PER_PROCESS 1
END

#=========================== chemistry ========================================
CHEMISTRY
  PRIMARY_SPECIES
    H+
    HCO3-
    Ca++
  /
  SECONDARY_SPECIES
    OH-
    CO3--
    CO2(aq)
    CaOH+
    CaHCO3+
    CaCO3(aq)
  /
  MINERALS
    Calcite
  /
  MINERAL_KINETICS
    Calcite
      RATE_CONSTANT 1.d-13 mol/cm^2-sec
    /
  /
  DATABASE ./calcite.dat
  LOG_FORMULATION
  ACTIVITY_COEFFICIENTS TIMESTEP
  OUTPUT
    ALL
    PH
    TOTAL
  /
END

#=========================== solver options ===================================
TIMESTEPPER TRANSPORT
  TS_ACCELERATION 8
/

#=========================== discretization ===================================
GRID
  TYPE structured
  ORIGIN 0.d0 0.d0 0.d0
  NXYZ 1 1 1
  BOUNDS
    0.d0 0.d0 0.d0
    1.d0 1.d0 1.d0
  /
END

#=========================== datasets =========================================
DATASET initial_Calcite_vol_frac
  HDF5_DATASET_NAME Calcite_vol_frac
  FILENAME calcite_mass_datasets.h5
END

DATASET initial_Calcite_area
  HDF5_DATASET_NAME Calcite_area
  FILENAME calcite_mass_datasets.h5
END

#=========================== fluid properties =================================
FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9
/

#=========================== material properties ==============================
MATERIAL_PROPERTY soil1
  ID 1
  POROSITY 0.5d0
/

#=========================== observation points ===============================
OBSERVATION
  REGION all
  AT_CELL_CENTER
/

#=========================== output options ===================================
OUTPUT
  PERIODIC_OBSERVATION TIMESTEP 1
/

#=========================== times ============================================
TIME
  FINAL_TIME 25.d0 s
  INITIAL_TIMESTEP_SIZE 0.5d0 s
  MAXIMUM_TIMESTEP_SIZE 0.5d0 s
/

#=========================== regions ==========================================
REGION all
  COORDINATES
    0.d0 0.d0 0.d0
    1.d0 1.d0 1.d0
  /
END

#=========================== transport conditions =============================
TRANSPORT_CONDITION initial
  TYPE zero_gradient
  CONSTRAINT_LIST
    0.d0 initial
  /
END


#=========================== constraints ======================================
CONSTRAINT initial
  CONCENTRATIONS
    H+     -1.d-5     T
    HCO3-   1.d-5      T
    Ca++    1.d-5      T
  /
  MINERALS
    ! based on database values, this specific surface area should be 
    ! equivalent to 1 cm^2/cm^3 at that volume fraction
#    Calcite  0.2 1.8450910805777365d0 cm^2/g
    Calcite  DATASET initial_Calcite_vol_frac DATASET initial_Calcite_area cm^2/g
  /
END

#=========================== condition couplers ===============================
# initial condition
INITIAL_CONDITION
  TRANSPORT_CONDITION initial
  REGION all
END

#=========================== stratigraphy couplers ============================
STRATA
  REGION all
  MATERIAL soil1
END


END_SUBSURFACE
