SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE richards
    / 
    SUBSURFACE_GEOMECHANICS geomech
      OPTIONS
        FLOW_COUPLING TWO_WAY_COUPLED
      /
    /
  / 
END

SUBSURFACE

#=========================== numerical methods ================================
NUMERICAL_METHODS FLOW

  TIMESTEPPER
    MAX_TS_CUTS 200
  /

  NEWTON_SOLVER
    RTOL 1.000d-08
    STOL 1.000d-30
    ITOL 1.000d-08
    ITOL_UPDATE 0.0001
  /

END

EOS WATER
  DENSITY LINEAR 990.0 101325 4.400d-10
  VISCOSITY CONSTANT 0.00066
END

GRID
  TYPE STRUCTURED
  BOUNDS
    0.0 0.0 0.0 
    1.0 1.0 100.0 
  /
  NXYZ 1 1 30 
  GRAVITY 0.0 0.0 0.0 
END


TIME
  FINAL_TIME 0.4 s
  INITIAL_TIMESTEP_SIZE 0.1 s
  MAXIMUM_TIMESTEP_SIZE 1.0 s
END

MATERIAL_PROPERTY soil1
  ID 1
  CHARACTERISTIC_CURVES default
  POROSITY 0.5
  TORTUOSITY 1.0
  PERMEABILITY
    PERM_ISO 1.000d-12
  /
  GEOMECHANICS_SUBSURFACE_PROPS
    COMPRESSIBILITY_FUNCTION LINEAR_MODEL
  /
END


skip
OUTPUT
  TIMES  s 0.35 0.7 1.05 1.4 1.75 2.1 2.45 2.8 3.15 3.5
  FORMAT TECPLOT POINT
  VARIABLES 
    POROSITY
    LIQUID_PRESSURE
    PERMEABILITY
  /
END
noskip
CHARACTERISTIC_CURVES default
  SATURATION_FUNCTION VAN_GENUCHTEN
   ALPHA 0.0001
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
  / 
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
   M 0.5
   LIQUID_RESIDUAL_SATURATION 0.1
  / 
END

REGION all
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 100.0 
  /
END

REGION bottom
  FACE BOTTOM
  COORDINATES
    0.0 0.0 0.0 
    1.0 1.0 0.0 
  /
END

REGION top
  FACE TOP
  COORDINATES
    0.0 0.0 100.0 
    1.0 1.0 100.0 
  /
END

FLOW_CONDITION initial
  TYPE
    LIQUID_PRESSURE DIRICHLET
  /
    LIQUID_PRESSURE 101325.0
END

FLOW_CONDITION top_flow
  TYPE
    LIQUID_PRESSURE DIRICHLET
  /
    LIQUID_PRESSURE 101325.0
END

FLOW_CONDITION bottom_flow
  TYPE
    LIQUID_FLUX neumann
  /
    LIQUID_FLUX 0.0
END

INITIAL_CONDITION initial
  FLOW_CONDITION initial
  REGION all
END

BOUNDARY_CONDITION top
  FLOW_CONDITION top_flow
  REGION top
END

BOUNDARY_CONDITION bottom
  FLOW_CONDITION bottom_flow
  REGION bottom
END

STRATA
  REGION all
  MATERIAL soil1
END

END_SUBSURFACE

GEOMECHANICS

GEOMECHANICS_GRID
  TYPE UNSTRUCTURED geomech_dat/usg.mesh
  GRAVITY 0.0 0.0 0.0 
END

GEOMECHANICS_MAPPING_FILE flow_geomech_mapping.dat

GEOMECHANICS_REGRESSION
  VERTICES
    5
    14
    23
    32
    41
    50
    59
    68
    77
    86
    95
    104
    113
    122
    131
    140
    149
    158
    167
    176
    185
    194
    203
    212
    221
    230
    239
    248
    257
    266
    275
    284
  /
  VARIABLES
    DISPLACEMENT_Z
    STRAIN_ZZ
    STRESS_ZZ
  /
END

GEOMECHANICS_TIME
  COUPLING_TIMESTEP_SIZE 0.1 s
END

GEOMECHANICS_REGION all_geomech
  FILE geomech_dat/all.vset
END

GEOMECHANICS_REGION north_geomech
  FILE geomech_dat/north.vset
END

GEOMECHANICS_REGION south_geomech
  FILE geomech_dat/south.vset
END

GEOMECHANICS_REGION east_geomech
  FILE geomech_dat/east.vset
END

GEOMECHANICS_REGION west_geomech
  FILE geomech_dat/west.vset
END

GEOMECHANICS_REGION top_traction
  FILE geomech_dat/top.ss
END

GEOMECHANICS_REGION bottom_geomech
  FILE geomech_dat/bottom.vset
END

GEOMECHANICS_CONDITION west_geomech
  TYPE
    DISPLACEMENT_X DIRICHLET
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION east_geomech
  TYPE
    DISPLACEMENT_X DIRICHLET
  END
    DISPLACEMENT_X 0.0
END

GEOMECHANICS_CONDITION north_geomech
  TYPE
    DISPLACEMENT_Y DIRICHLET
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_CONDITION bottom_geomech
  TYPE
    DISPLACEMENT_Z DIRICHLET
  END
    DISPLACEMENT_Z 0.0
END

GEOMECHANICS_CONDITION south_geomech
  TYPE
    DISPLACEMENT_Y DIRICHLET
  END
    DISPLACEMENT_Y 0.0
END

GEOMECHANICS_CONDITION top_traction
  TYPE
    TRACTION NEUMANN
  END
  STRESS_TENSOR 0.d0 0.d0 1101325.d0 0.d0 0.d0 0.d0
END

GEOMECHANICS_BOUNDARY_CONDITION bottom_geomech
  GEOMECHANICS_CONDITION bottom_geomech
  GEOMECHANICS_REGION bottom_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION east_geomech
  GEOMECHANICS_CONDITION east_geomech
  GEOMECHANICS_REGION east_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION west_geomech
  GEOMECHANICS_CONDITION west_geomech
  GEOMECHANICS_REGION west_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION north_geomech
  GEOMECHANICS_CONDITION north_geomech
  GEOMECHANICS_REGION north_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION south_geomech
  GEOMECHANICS_CONDITION south_geomech
  GEOMECHANICS_REGION south_geomech
END

GEOMECHANICS_BOUNDARY_CONDITION top_traction
  GEOMECHANICS_CONDITION top_traction
  GEOMECHANICS_REGION top_traction
END

GEOMECHANICS_STRATA
  GEOMECHANICS_REGION all_geomech
  GEOMECHANICS_MATERIAL soil1
END

skip
GEOMECHANICS_OUTPUT
  TIMES  s 0.35 0.7 1.05 1.4 1.75 2.1 2.45 2.8 3.15 3.5
  FORMAT TECPLOT POINT
  FORMAT HDF5
END
noskip

GEOMECHANICS_MATERIAL_PROPERTY soil1
  ID 1
  ROCK_DENSITY 2000.0
  YOUNGS_MODULUS 10000000000.0
  POISSONS_RATIO 0.0
  BIOT_COEFFICIENT 1.0
  THERMAL_EXPANSION_COEFFICIENT 0.0
END

END_GEOMECHANICS
