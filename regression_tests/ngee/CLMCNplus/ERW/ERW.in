#Description: Enhanced Rock Weathering reactions

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
        OPTIONS
      /
    /
  /

END

SUBSURFACE

#+++++++++++++++++++++++ I. DOMAINS +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#======================= I-1. discretization ===================================
GRID
  TYPE structured
  ORIGIN 0.d0 0.d0 0.d0
  NXYZ 1 1 15
  DXYZ 
     1.0d1 
     1.0d1 
     13.851152141963599d0 \
     11.126150294204420d0 \ 
     6.7483512780057175d0 \ 
     4.0930819526214002d0 \ 
     2.4825796969813321d0 \
     1.5057607013992766d0 \
     0.91329003158906108d0 \
     0.55393840536868488d0 \
     0.33598062644843263d0 \
     0.20378255101043175d0 \
     0.12360036510228053d0 \
     0.074967410986208557d0 \
     0.04547003324241320d0 \
     0.027578969259676251d0 \
     0.017512817916255204d0
   /
END

PROC 1 1 1

#======================= I-2.regions ===========================================
REGION top
  COORDINATES
    -1.d20 -1.d20 42.103197276099188d0
    1.0d20 1.0d20 42.103197276099188d0
  /
  FACE TOP
END

REGION bottom
  COORDINATES
    -1.d20 -1.d20 0.0d0
    1.0d20 1.0d20 0.0d0
  /
  FACE BOTTOM
END

REGION all
  COORDINATES
    -1.d20 -1.d20 0.0d0
    1.0d20 1.0d20 42.103197276099188d0
  /
  FACE TOP
END

REGION obs_pt
  COORDINATE 0.5 0.5 1.9
END

#=========================== useful transport parameters =======================
SPECIFIED_VELOCITY
  UNIFORM? YES
  DATASET 0.d0 0.d0 0.d0
END

REFERENCE_LIQUID_DENSITY 1.d3

#=========================== chemistry ========================================
CHEMISTRY
  PRIMARY_SPECIES
    H2O
    Methane(aq)
    CO2(aq)
    N2(aq)
    N2O(aq)
    O2(aq)
    SiO2(aq)
    #Al+++
    H+
    Ca++
    #Mg++
    Na+
    NH4+
    Cl-
    NO3-
  /
  SECONDARY_SPECIES
    NH3(aq)
    OH-
    CO3--
    HNO3(aq)    
    NaNO3(aq)
    NaCl(aq)
    NaCO3-
    NaHCO3(aq)
    HCl(aq)
    CaCO3(aq)
    CaCl+
    CaCl2(aq)
    CaHCO3+
    CO(aq)
    HCO3-
    H2SiO4--
    H4(H2SiO4)4----
    H6(H2SiO4)4--
    HSiO3-
    H3SiO4-

  /
  DECOUPLED_EQUILIBRIUM_REACTIONS
    NO3-
    N2(aq)
    Methane(aq)

  /
  MINERALS
    #Anorthite        ! CaAl2Si2O8
    Calcite           ! CaCO3
    #Diopside         ! CaMgSi2O6
    #Enstatite        ! MgSiO3
    #Forsterite       ! Mg2SiO3
    #Tremolite        ! Ca2Mg5Si8O22(OH)2
    Wollastonite      ! CaSiO3
  /
  
  IMMOBILE_SPECIES
    #
  /
  
  PASSIVE_GAS_SPECIES
    CH4(g)
    CO2(g)
    CO2(g)*
    O2(g)
    O2(g)*
    N2(g)
    N2(g)*
    N2O(g)*
    NH3(g)
  /
  
  MINERAL_KINETICS
    Calcite
      RATE_CONSTANT 1.d-18
    /
    Wollastonite
      RATE_CONSTANT 1.d-10
    /
  /


  REACTION_SANDBOX
    ! (Begin) ELM CTC-CN SOM decomposition sandboxes -------------------------------------------------------------------
    ! (End) ELM CTC-CN PLANT N uptake sandboxes ------------------------------------------------------------------------
  / ! REACTION_SANDBOX


  TRUNCATE_CONCENTRATION 1.d-15

 # LOG_FORMULATION
  DATABASE ./hanford.dat

  OUTPUT
    PH
    TOTAL
    PRIMARY_SPECIES
    SECONDARY_SPECIES
    IMMOBILE
    GASES
    MINERALS
  /
END

#=========================== transport constraints ============================
CONSTRAINT initial
  CONCENTRATIONS
    H2O         5.56d1     T
    Methane(aq) 1.d-15     T
    CO2(aq)     6.6d-4     G CO2(g)
    N2(aq)      4.65d-15   G N2(g)*
    N2O(aq)     4.65d-15   G N2O(g)*
    O2(aq)      1.06d-4    T
    SiO2(aq)    1.d-20     T
    #Al+++      1.d-20     T
    H+          7.d0       P
    Ca++        0.01d0     T Calcite
    #Mg++        0.01d0    T
    Na+         4.69d-2    T
    NH4+        3.d-5      T
    Cl-         5.46d-2    T
    #HCO3-       6.6d-4     G CO2(g)
    NO3-        4.5d-10    T
    /
  IMMOBILE     # [mol/m^3 bulk]
    !
    /
       
  MINERALS
    #Anorthite    0.d0      1. cm^2/cm^3
    Calcite       1.d-15    1. cm^2/cm^3
    #Diopside     0.d0      1. cm^2/cm^3
    #Enstatite    0.d0      1. cm^2/cm^3
    #Forsterite   0.d0      1. cm^2/cm^3
    #Tremolite    0.d0      1. cm^2/cm^3
    Wollastonite  0.d0     1. cm^2/cm^3
    /
END

CONSTRAINT rocky_app
  CONCENTRATIONS
    H2O         5.56d1     T
    Methane(aq) 1.d-15     T
    O2(aq)      1.06d-4    T
    CO2(aq)     6.6d-4     G CO2(g)
    N2(aq)      4.65d-15   G N2(g)*
    N2O(aq)     4.65d-15   G N2O(g)*
    SiO2(aq)    1.d-20     T
    #Al+++      1.d-20     T
    H+          7.d0       P
    Ca++        0.01d0     T Calcite
    #Mg++        0.01d0    T
    Na+         4.69d-2    T
    NH4+        3.d-5      T
    Cl-         5.46d-2    T
    #HCO3-       6.6d-4     G CO2(g)
    NO3-        4.5d-10    T
    /
  IMMOBILE     # [mol/m^3 bulk]
    !
    /
       
  MINERALS
    #Anorthite    0.d0      1. cm^2/cm^3
    Calcite       1.d-15    1. cm^2/cm^3
    #Diopside     0.d0      1. cm^2/cm^3
    #Enstatite    0.d0      1. cm^2/cm^3
    #Forsterite   0.d0      1. cm^2/cm^3
    #Tremolite    0.d0      1. cm^2/cm^3
    Wollastonite  1.d2      1. cm^2/cm^3
    /
END

CONSTRAINT air_water
  CONCENTRATIONS
    H2O         5.56d1     T
    Methane(aq) 1.d-15     T
    CO2(aq)     6.6d-4     G CO2(g)*
    N2(aq)      4.65d-15   G N2(g)*
    N2O(aq)     4.65d-15   G N2O(g)*
    O2(aq)      1.06d-4    T
    SiO2(aq)    1.d-20     T
    #Al+++      1.d-20     T
    H+          7.d0       P
    Ca++        0.01d0     T Calcite
    #Mg++        0.01d0    T
    Na+         4.69d-2    T
    NH4+        3.d-5      T
    Cl-         5.46d-2    T
    #HCO3-       6.6d-4     G CO2(g)*
    NO3-        4.5d-10    T
    /
  IMMOBILE     # [mol/m^3 bulk]
    !
    /
       
  MINERALS
    #Anorthite    0.d0      1. cm^2/cm^3
    Calcite       0.d0      1. cm^2/cm^3
    #Diopside     0.d0      1. cm^2/cm^3
    #Enstatite    0.d0      1. cm^2/cm^3
    #Forsterite   0.d0      1. cm^2/cm^3
    #Tremolite    0.d0      1. cm^2/cm^3
    Wollastonite  0.d0      1. cm^2/cm^3
    /
END


#=========================== solver options ===================================
NUMERICAL_METHODS TRANSPORT
  LINEAR_SOLVER TRANSPORT
    !SOLVER DIRECT
    SOLVER ITERATIVE     ! default: ITERATIVE or KRYLOV: KSP_TYPE of BCGS and PC_TYPE of BJACOBI, if not modified below
    PC_TYPE JACOBI       ! default (iterative): BJACOBI. 
    KSP_TYPE fgmres      ! default: BCGS. NOT much difference 
  /

  NEWTON_SOLVER
    NUMERICAL_JACOBIAN
    ATOL 1.d-20
    RTOL 1.d-15
    STOL 1.d-10
    ITOL 1.d-10
  /
END

#=========================== fluid properties =================================
FLUID_PROPERTY
  PHASE LIQUID
  DIFFUSION_COEFFICIENT 1.d-9
END

FLUID_PROPERTY
  PHASE gas
  DIFFUSION_COEFFICIENT 1.000d-05
END

#=========================== material properties ==============================
MATERIAL_PROPERTY soil1
  ID 1
  POROSITY 0.25d0
  TORTUOSITY 1.d0
  SATURATION_FUNCTION default
END

# == saturation / permeability functions ======================================
SATURATION_FUNCTION HD
SATURATION_FUNCTION_TYPE VAN_GENUCHTEN
RESIDUAL_SATURATION 0.115
LAMBDA 0.286
ALPHA 1.9401d-4
/

#=========================== output options ===================================
OUTPUT
  !PERIODIC_OBSERVATION TIMESTEP 1
  SCREEN PERIODIC 10
  PERIODIC TIMESTEP 1
  FORMAT HDF5
END

#=========================== times ============================================
TIME
  FINAL_TIME 3650.d0 d
  INITIAL_TIMESTEP_SIZE 0.5d0 h
  MAXIMUM_TIMESTEP_SIZE 24.d0 h
END


#=========================== observation points ===============================
OBSERVATION
  REGION obs_pt
END

#=========================== transport conditions =============================
TRANSPORT_CONDITION initial
  TYPE zero_gradient
  CONSTRAINT_LIST
    0.d0 initial
  /
END

TRANSPORT_CONDITION rockypowder_app
  TYPE zero_gradient
  CONSTRAINT_LIST
    0.d0 rocky_app
  /
END

TRANSPORT_CONDITION air_water_interface
  TYPE dirichlet
  CONSTRAINT_LIST
    0.d0 air_water
  /
END


#=========================== condition couplers ===============================
# initial condition
INITIAL_CONDITION
  TRANSPORT_CONDITION initial
  REGION all
END

INITIAL_CONDITION
  TRANSPORT_CONDITION rockypowder_app
  REGION top
END

# top boundary condition
BOUNDARY_CONDITION
  TRANSPORT_CONDITION air_water_interface
  REGION top
END

#=========================== stratigraphy couplers ============================
STRATA
  REGION all
  MATERIAL soil1
END

#=========================== regression =======================================
REGRESSION
  CELL_IDS
    1
    5
    10
    15
  /
END

#
END_SUBSURFACE
#
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
